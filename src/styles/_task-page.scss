@import './task-common';

$task-page-max-width: 1200px;
$task-page-min-height: 90vh;
$task-page-margin: 1.5vh auto 0 auto;
$task-page-bg: #fcfcfe;
$task-page-radius: 24px;
$task-page-shadow: 0 8px 36px rgba(44,62,80,0.18);
$task-page-width: 96vw;

$task-header-bg: #222c68;
$task-header-color: #fff;
$task-header-padding: 1.2rem 2.5rem 1rem 2.5rem;
$task-header-radius: 24px 24px 0 0;
$task-header-font-size: 1.55rem;
$task-header-font-weight: 700;
$task-header-min-height: 44px;

$task-title-size: 1.45rem;
$task-title-weight: 700;
$task-title-color: #fff;
$task-title-spacing: 0.5px;
$task-title-line: 1.1;

$task-meta-size: 0.98rem;
$task-meta-color: #cfd6eb;
$task-meta-gap: 1.4em;
$meta-label-color: #cfd6eb;
$meta-value-color: #fff;

$task-actions-gap: 0.3rem;

$icon-btn-color: #fff;
$icon-btn-size: 1.7rem;
$icon-btn-bg-hover: rgba(255,255,255,0.12);

$task-tabs-bg: #f6f7fa;
$task-tabs-gap: 0.4em;
$task-tabs-padding: 0.6em 2.5em 0.4em 2.5em;
$task-tabs-border: 1.5px solid #e3e6eb;
$task-tabs-btn-radius: 9px 9px 0 0;
$task-tabs-btn-color: #222c68;
$task-tabs-btn-bg-active: #e5e8f5;
$task-tabs-btn-color-active: #1a237e;

$task-main-gap: 2.5rem;
$task-main-padding: 1.5rem 2.5rem 2.4rem 2.5rem;
$task-main-bg: #fcfcfe;

$task-info-gap: 1.15rem;
$info-row-font-size: 1.13rem;
$info-row-gap: 1.2em;
$info-title-weight: 700;
$info-title-color: #222c68;
$edit-btn-color: #b0b7d6;
$edit-btn-hover: #222c68;

$input-radius: 7px;
$input-border: 1.3px solid #bfc6db;
$input-padding: 2px 8px;
$input-focus-border: #222c68;

$history-bg: #f7f8fa;
$history-radius: 7px;
$history-padding: 0.6em 1.1em;
$history-shadow: 0 1px 3px 0 rgba(153,167,190,0.045);
$history-gap: 1.3em;
$history-date-color: #7a7a9a;
$history-user-color: #293184;
$history-user-weight: 600;

$file-bg: #f7f8fa;
$file-radius: 7px;
$file-padding: 0.6em 1.1em;
$file-icon-color: #222c68;
$file-icon-size: 1.5em;
$file-size-color: #7a7a9a;
$file-upload-margin: 1em;
$upload-btn-color: #293184;
$upload-btn-weight: 500;
$upload-btn-size: 1.1em;

$comments-bg: #f7f8fa;
$comments-radius: 18px;
$comments-shadow: 0 0 0 1.5px #e3e6eb;
$comments-padding: 1.5rem 1.2rem;
$comments-title-color: #222c68;
$comments-title-size: 1.13rem;

$comment-card-bg: #fff;
$comment-card-radius: 10px;
$comment-card-shadow: 0 1px 6px 0 rgba(153,167,190,0.09);
$comment-card-padding: 0.7em 1em 0.8em 1em;
$avatar-size: 38px;
$avatar-radius: 50%;
$comment-meta-size: 1.05em;
$comment-meta-gap: 1.4em;
$author-color: #222c68;
$author-weight: 600;
$date-color: #999;
$text-size: 1.09em;

$add-comment-gap: 0.7em;
$add-comment-margin: 1.7em;
$add-comment-textarea-radius: 10px;
$add-comment-textarea-border: 1.5px solid #d0d5de;
$add-comment-textarea-padding: 0.6em 0.9em;
$add-comment-textarea-size: 1.13em;
$add-comment-btn-bg: #222c68;
$add-comment-btn-radius: 50%;
$add-comment-btn-size: 1.75em;
$add-comment-btn-width: 44px;
$add-comment-btn-height: 44px;
$add-comment-btn-disabled-bg: #b0bec5;

$loading-label-size: 1.2rem;
$loading-label-color: #333;

.task-page-root {
  max-width: $task-page-max-width;
  min-height: $task-page-min-height;
  margin: $task-page-margin;
  background: $task-page-bg;
  border-radius: $task-page-radius;
  box-shadow: $task-page-shadow;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  width: $task-page-width;
}

.task-page-header {
  background: $task-header-bg;
  color: $task-header-color;
  padding: $task-header-padding;
  font-size: $task-header-font-size;
  font-weight: $task-header-font-weight;
  border-radius: $task-header-radius;
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  min-height: $task-header-min-height;
}

.task-page-title {
  font-size: $task-title-size;
  font-weight: $task-title-weight;
  letter-spacing: $task-title-spacing;
  line-height: $task-title-line;
}

.task-meta {
  font-size: $task-meta-size;
  margin-top: 0.25em;
  color: $task-meta-color;
  display: flex;
  gap: $task-meta-gap;
}
.meta-label { color: $meta-label-color; }
.meta-value { color: $meta-value-color; }

.task-page-actions {
  display: flex;
  gap: $task-actions-gap;
}

.icon-btn {
  background: none;
  border: none;
  color: $icon-btn-color;
  font-size: $icon-btn-size;
  cursor: pointer;
  padding: 8px;
  border-radius: 50%;
  transition: background 0.16s;
  display: flex;
  align-items: center;
  justify-content: center;
  &:hover {
    background: $icon-btn-bg-hover;
  }
}

.task-tabs {
  display: flex;
  gap: $task-tabs-gap;
  padding: $task-tabs-padding;
  background: $task-tabs-bg;
  border-bottom: $task-tabs-border;
  button {
    background: none;
    border: none;
    padding: 7px 22px;
    border-radius: $task-tabs-btn-radius;
    cursor: pointer;
    transition: background 0.16s, color 0.16s;
    font-size: 1.08em;
    color: $task-tabs-btn-color;
    font-weight: 500;
    position: relative;
    &.active,
    &:hover {
      background: $task-tabs-btn-bg-active;
      color: $task-tabs-btn-color-active;
    }
  }
}

.task-page-main {
  flex: 1 1 auto;
  display: flex;
  flex-direction: row;
  gap: $task-main-gap;
  padding: $task-main-padding;
  min-width: 0;
  background: $task-main-bg;
  box-sizing: border-box;
  width: 100%;
  max-width: 100%;
  overflow-x: hidden;
}

.task-page-info {
  flex: 1 1 55%;
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: $task-info-gap;
  word-break: break-word;
}

.info-row {
  display: flex;
  font-size: $info-row-font-size;
  gap: $info-row-gap;
  align-items: flex-start;
  line-height: 1.47;
  word-break: break-word;
}

.info-title {
  font-weight: $info-title-weight;
  min-width: 130px;
  color: $info-title-color;
}

.edit-btn {
  background: none;
  border: none;
  color: $edit-btn-color;
  margin-left: 8px;
  cursor: pointer;
  font-size: 1.13em;
  vertical-align: middle;
  &:hover {
    color: $edit-btn-hover;
  }
}

input[type="text"], input[type="number"], input[type="datetime-local"] {
  font-size: 1em;
  border-radius: $input-radius;
  border: $input-border;
  padding: $input-padding;
  margin-left: 2px;
  outline: none;
  min-width: 90px;
}
input:focus {
  border-color: $input-focus-border;
}

.task-history {
  flex: 1 1 55%;
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: 1.1em;
  font-size: 1.08em;
}
.history-record {
  background: $history-bg;
  border-radius: $history-radius;
  padding: $history-padding;
  box-shadow: $history-shadow;
  display: flex;
  gap: $history-gap;
  align-items: center;
}
.history-date { color: $history-date-color; min-width: 120px; }
.history-user { font-weight: $history-user-weight; color: $history-user-color; min-width: 70px;}
.history-text { flex: 1; }

.task-files {
  flex: 1 1 55%;
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: 1.1em;
}
.file-row {
  display: flex;
  align-items: center;
  gap: 0.8em;
  background: $file-bg;
  border-radius: $file-radius;
  padding: $file-padding;
}
.file-icon {
  color: $file-icon-color;
  font-size: $file-icon-size;
}
.file-size, .file-date {
  font-size: 0.97em;
  color: $file-size-color;
}
.file-upload {
  margin-top: $file-upload-margin;
}
.upload-btn {
  cursor: pointer;
  color: $upload-btn-color;
  font-weight: $upload-btn-weight;
  font-size: $upload-btn-size;
  display: inline-flex;
  align-items: center;
  gap: 0.2em;
  .material-icons { font-size: 1.2em; }
}

.task-page-comments {
  flex: 1 1 45%;
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: 1.4rem;
  background: $comments-bg;
  border-radius: $comments-radius;
  box-shadow: $comments-shadow;
  padding: $comments-padding;
  max-height: 100%;
  overflow-y: auto;
  word-break: break-word;
}
.comments-title {
  font-weight: 700;
  margin-bottom: 1.1rem;
  font-size: $comments-title-size;
  color: $comments-title-color;
}
.comment-card {
  display: flex;
  align-items: flex-start;
  gap: 0.9em;
  background: $comment-card-bg;
  border-radius: $comment-card-radius;
  box-shadow: $comment-card-shadow;
  padding: $comment-card-padding;
  margin-bottom: 0.7em;
}
.avatar {
  width: $avatar-size;
  height: $avatar-size;
  border-radius: $avatar-radius;
  object-fit: cover;
  margin-right: 0.8em;
  flex-shrink: 0;
}
.comment-meta {
  font-size: $comment-meta-size;
  margin-bottom: 0.3em;
  display: flex;
  gap: $comment-meta-gap;
  align-items: center;
}
.author {
  font-weight: $author-weight;
  color: $author-color;
}
.date {
  color: $date-color;
  font-size: 0.97em;
}
.text {
  font-size: $text-size;
}
.add-comment {
  display: flex;
  align-items: flex-end;
  gap: $add-comment-gap;
  margin-top: $add-comment-margin;
  textarea {
    flex: 1 1 auto;
    border-radius: $add-comment-textarea-radius;
    border: $add-comment-textarea-border;
    padding: $add-comment-textarea-padding;
    min-height: 38px;
    font-size: $add-comment-textarea-size;
    resize: vertical;
    transition: border 0.18s;
    background: #fff;
    &:focus {
      border-color: $task-header-bg;
      outline: none;
    }
  }
  button {
    background: $add-comment-btn-bg;
    border: none;
    border-radius: $add-comment-btn-radius;
    width: $add-comment-btn-width;
    height: $add-comment-btn-height;
    color: #fff;
    font-size: $add-comment-btn-size;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.18s;
    cursor: pointer;
    &:disabled {
      opacity: 0.7;
      background: $add-comment-btn-disabled-bg;
      cursor: not-allowed;
    }
  }
}

.loading-label {
  font-size: $loading-label-size;
  text-align: center;
  margin-top: 3rem;
  color: $loading-label-color;
}

@media (max-width: 1000px) {
  .task-page-root {
    width: 100vw;
    border-radius: 0;
  }
  .task-page-main {
    flex-direction: column;
    gap: 1.2rem;
    padding: 1.2rem 1vw;
  }
  .task-page-info,
  .task-page-comments,
  .task-history,
  .task-files {
    flex: 1 1 100%;
    max-width: 100vw;
  }
  .task-tabs {
    padding-left: 1vw;
    padding-right: 1vw;
  }
}
